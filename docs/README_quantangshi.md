# 全唐詩爬蟲

這是一個專門用於爬取 ctext.org 網站上全唐詩的Python爬蟲程序。

## 功能特點

- 🎯 專門爬取全唐詩900卷
- 📁 每卷輸出一個單獨的txt文件
- 🛡️ 自動檢測驗證碼並記錄
- ⏱️ 智能延遲避免被反爬蟲
- 📊 詳細的爬取統計和摘要
- 🔄 支持斷點續爬

## 安裝依賴

```bash
pip install -r requirements.txt
```

或者手動安裝：

```bash
pip install requests beautifulsoup4 lxml urllib3
```

## 使用方法

### 基本用法

```bash
# 爬取所有900卷
python simple_quantangshi_crawler.py

# 指定輸出目錄
python simple_quantangshi_crawler.py --output my_quantangshi

# 調整延遲時間（秒）
python simple_quantangshi_crawler.py --delay 3.0
```

### 高級用法

```bash
# 爬取指定範圍的卷
python simple_quantangshi_crawler.py --start 1 --end 100

# 測試模式（只爬取前5卷）
python simple_quantangshi_crawler.py --test

# 完整參數示例
python simple_quantangshi_crawler.py \
    --start 1 \
    --end 900 \
    --output quantangshi_volumes \
    --delay 2.0
```

## 參數說明

- `--start`: 開始卷號（默認: 1）
- `--end`: 結束卷號（默認: 900）
- `--output, -o`: 輸出目錄（默認: quantangshi_volumes）
- `--delay`: 請求延遲秒數（默認: 2.0）
- `--test`: 測試模式，只爬取前5卷

## 輸出格式

### 文件結構
```
quantangshi_volumes/
├── 全唐詩_第001卷.txt
├── 全唐詩_第002卷.txt
├── ...
├── 全唐詩_第900卷.txt
└── 爬取摘要.txt
```

### 單卷文件格式
```
全唐詩 第1卷
==================================================

1. 詩歌標題
   作者: 作者名
   內容:
詩歌內容...
------------------------------

2. 詩歌標題
   作者: 作者名
   內容:
詩歌內容...
------------------------------
```

### 爬取摘要格式
```
全唐詩爬取摘要
==================================================

成功爬取卷數: 850
失敗卷數: 30
需要驗證碼卷數: 20

失敗的卷:
  第123卷
  第456卷
  ...

需要驗證碼的卷:
  第789卷
  ...
```

## 驗證碼處理

當遇到驗證碼時，爬蟲會：

1. 自動檢測並記錄需要驗證碼的卷
2. 繼續爬取其他卷
3. 在摘要中列出所有需要驗證碼的卷
4. 為需要驗證碼的卷創建空文件

### 手動處理驗證碼

如果遇到驗證碼，可以：

1. 手動訪問對應的網頁完成驗證
2. 重新運行爬蟲，跳過已完成的卷：

```bash
# 從第100卷開始爬取
python simple_quantangshi_crawler.py --start 100
```

## 注意事項

1. **尊重網站**: 請合理設置延遲時間，避免對服務器造成過大負擔
2. **遵守robots.txt**: 請遵守網站的robots.txt規則
3. **僅供學習**: 本工具僅供學習和研究使用
4. **版權聲明**: 請注意全唐詩的版權問題

## 故障排除

### 常見問題

1. **連接超時**
   - 增加延遲時間：`--delay 5.0`
   - 檢查網絡連接

2. **驗證碼頻繁出現**
   - 增加延遲時間
   - 使用代理IP
   - 手動完成驗證後繼續

3. **提取內容為空**
   - 檢查網頁結構是否變化
   - 更新爬蟲代碼

### 調試模式

可以修改代碼中的 `print` 語句來查看詳細的調試信息。

## 版本歷史

- v2.0: 改進的詩歌提取算法，更好的驗證碼處理
- v1.0: 基礎版本，支持基本爬取功能

## 貢獻

歡迎提交 Issue 和 Pull Request 來改進這個爬蟲。

## 免責聲明

本工具僅供學習和研究使用，使用者需要自行承擔使用風險，並遵守相關法律法規和網站使用條款。 